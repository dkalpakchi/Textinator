{% extends "layout.html" %}

{% block custom_styles %}
  <link rel="stylesheet" href="{{ static('tippy.js/themes/translucent.css') }}">
  <link rel="stylesheet" href="{{ static('tippy.js/dist/tippy.css') }}">
{% endblock %}

{% block custom_scripts %}
  <script src="{{ static('medium-zoom/dist/medium-zoom.min.js') }}"></script>
{% endblock %}

{% block content %}
  <div class="meta">
    {% for key, items in meta.items() %}
      <nav class="panel is-primary">
        <p class="panel-heading">{{ key|capitalize }}</p>
        <div class="panel-block">
          {% for item in items %}
            {% if key == 'images' %}
              <div class="card">
                <header class="card-header has-background-dark">
                  <p class="card-header-title has-text-white">
                    {{ item.rpartition('/')[-1] }}
                  </p>
                </header>
                <div class="card-image">
                  <figure class="image is-4by3">
                    <img src="{{item}}" data-zoomable="true">
                  </figure>
                </div>
              </div>
            {% endif %}
          {% endfor %}
        </div>
      </nav>
    {% endfor %}
  </div>


  <script type="text/javascript">
    const zoom = mediumZoom('[data-zoomable]', {
      background: 'rgba(0, 0, 0, 0.94)'
    });
    
    zoom.on(
      'open',
      event => {
        event.target.parentNode.className = ""
      }
    );

    zoom.on(
      "opened",
      event => {
        var $hidden = $('.medium-zoom-image--hidden'),
            name = $hidden.closest('.card').find('.card-header-title').text();
        
        tippy('.medium-zoom-image--opened', {
          content: name,
          theme: 'light'
        })
      }
    )

    zoom.on(
      'close',
      event => {
        event.target.parentNode.className = "image is-4by3"
      }
    )
  </script>
{% endblock %}